import{getContext as e,getElement as t,getServerState as n,store as c,withSyncEvent as s}from"@wordpress/interactivity";var o={438:e=>{e.exports=import("@wordpress/interactivity-router")}},r={};function l(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return o[e](n,n.exports,l),n.exports}const{addQueryArgs:a}=window.wp.url;function i(e){return 250<=e?"250+":e}function u(e,t,n){const c=n.find(e=>e.value===t);return c?c[e]:null}const{state:d,actions:p}=c("prc-platform/facets-context-provider",{state:{mouseEnterPreFetchTimer:500,navigateTimer:1e3,epSortByDate:!1,isProcessing:!1,get hasPosts(){return d?.pagination?.total_rows>0},get postCount(){return d?.pagination?.total_rows||0},get getServerSelected(){return n().selected},get getUpdatedUrl(){if(void 0!==d.selected)return p.constructNewUrl(d.selected)},get choices(){const t=e(),{facetSlug:n,limit:c,facetType:s}=t;return n&&d.facets[n]?"dropdown"===s?[...d.facets[n].choices].sort((e,t)=>{const n=Number(e.label),c=Number(t.label);return isNaN(n)||isNaN(c)?t.label.localeCompare(e.label):c-n}):[...d.facets[n].choices].sort((e,t)=>{const c=d.facets[n].selected.includes(e.value),s=d.facets[n].selected.includes(t.value);return c!==s?s-c:t.count-e.count}).slice(0,c):[]},get expandedChoices(){const t=e(),{facetSlug:n}=t;return d.facets[n]?d.facets[n].choices.filter(e=>{const t=d.facets[n].selected.includes(e.value),c=d.choices.includes(e);return!t&&!c}).sort((e,t)=>t.count-e.count):[]},get hasChoices(){const t=e(),{facetSlug:n}=t,{facets:c}=d;return c[n].choices.length>0},get hasSelections(){const t=e(),{facetSlug:n}=t,{facets:c}=d;return c[n].selected.length>0},get hasExpandedChoices(){return d.expandedChoices&&d.expandedChoices.length>0},get isExpanded(){const t=e(),{expanded:n}=t;return n},get isInputChecked(){const t=e(),{choice:n,facetSlug:c}=t,{value:s}=n,{facets:o}=d;return o[c].selected.includes(s)},get isInputDisabled(){const t=e(),{choice:n}=t,{value:c,label:s,facetSlug:o}=n;return 0===u("count",c,d.facets[o].choices)},get isInputError(){return!1},get isInputSuccess(){return!1},get isInputRequired(){return!1},get isInputProcessing(){return!1},get isInputHidden(){return!1},get isInputReadOnly(){return!1},get inputName(){const t=e(),{choice:n}=t;return n.slug},get inputLabel(){const t=e(),{choice:n}=t,{value:c,label:s,facetSlug:o}=n;return`${s} (${i(u("count",c,d.facets[o].choices))})`},get inputId(){const t=e(),{choice:n}=t,{slug:c,term_id:s}=n;return`facet_${c}_${s}`},get inputValue(){const t=e(),{choice:n}=t;return n.value},get inputPlaceholder(){const t=e(),{placeholder:n,facetType:c,facetSlug:s}=t;let o=n;return"dropdown"===c&&d.facets[s].selected.length>0&&(o=d.facets[s].selected[0].toString().replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())),o},get isSelected(){const t=e(),{choice:n}=t,{tokens:c}=d,{value:s}=n;return c.includes(s)},get isOpen(){const{expanded:t}=e();return t},get inputOptions(){const t=e(),{facetSlug:c,facetType:s,searchTerm:o}=t,{choices:r}=n().facets[c];let l=r;if(o&&o.length>0&&r){const e=r.filter(e=>e.label.toLowerCase().includes(o.toLowerCase()));l=e.length>0?e:r}return l.map(e=>({value:e.value,label:`${e.label} (${i(e.count)})`}))},get hasValue(){const t=e(),{facetSlug:n}=t,{selected:c}=d.facets[n];return c.length>0},get hasClearIcon(){return!1},get activeIndex(){const t=e(),{activeIndex:n}=t;return n||0}},actions:{constructNewUrl(e=!1){const t={};if(!1===e)return;Object.keys(e).forEach(n=>{n.startsWith(d.urlKey)?t[n]=e[n]:Array.isArray(e[n])?t[`${d.urlKey}${n}`]=e[n].join(","):t[`${d.urlKey}${n}`]=e[n]}),Object.keys(t).forEach(e=>{""!==t[e]&&"object"!=typeof t[e]||delete t[e]});const n=window.location.href.split("?")[0].replace(/\/page\/\d+\//,"/");return a(n,t)},*updateResults(){const e=window.location.href,c=d.getUpdatedUrl;if(c===e)return;d.isProcessing=!0;const s=yield Promise.resolve().then(l.bind(l,438));yield s.actions.navigate(c);const o=n();d.facets=o.facets,d.tokens=o.tokens;const{ref:r}=t();r?r.scrollIntoView({behavior:"smooth",block:"start"}):window.scrollTo({top:0,behavior:"smooth"}),d.isProcessing=!1},*prefetch(e){const t=yield Promise.resolve().then(l.bind(l,438));d.prefetched.includes(e)||(d.prefetched.push(e),yield t.actions.prefetch(e))},onClear:(e,t=null)=>{const n=d.selected;return e?t?(n[e]=n[e].filter(e=>e!==t),void(d.selected={...n})):(n[e]=[],d.selected={...n},d.selected):(d.selected={},void p.updateResults())},clearFacet:()=>{const{facetSlug:t}=e();p.onClear(t)},*onInputMouseEnter(){const t=e(),{facetSlug:n,value:c,selected:s}=t,o={...s||[],[c]:c},r=p.constructNewUrl(o);yield p.prefetch(r)},onInputMouseLeave:s(e=>{}),onInputFocus:s(t=>{const n=e(),{facetType:c}=n;"dropdown"===c&&(n.expanded=!n.expanded)}),onInputBlur:s(t=>{let n=!1;if(!n){n=!0;const t=e(),{facetType:c}=t;"dropdown"===c&&setTimeout(()=>{t.expanded=!1,n=!1},150)}}),onInputKeyDown:s(t=>{t.preventDefault();const n=e();if("dropdown"===n.facetType&&"Enter"===t.key){const{activeIndex:e,facetSlug:t}=n,{inputOptions:c,selected:s}=d,{value:o}=c[e];s[t]=[o],setTimeout(()=>{n.expanded=!1},150)}}),onInputKeyUp:s(t=>{const n=e(),{expanded:c,facetType:s}=n;"dropdown"===s&&(n.searchTerm=t.target.value,c||(n.expanded=!0),40!==t.keyCode||"ArrowDown"!==t.key?38!==t.keyCode||"ArrowUp"!==t.key?"Escape"===t.key&&(n.expanded=!1):p.moveThroughChoices(-1,t.target):p.moveThroughChoices(1,t.target))}),onDropdownArrowClick:s(t=>{const n=e(),{facetType:c}=n;"dropdown"===c&&(n.expanded=!n.expanded)}),moveThroughChoices:(t,n)=>{const{inputOptions:c}=d,{activeIndex:s}=e();let o=null;o=null===s||isNaN(s)?0:s+t,o<0&&(o=c.length-1),o>=c.length&&(o=0);const r=c[o].value,l=n.parentElement.parentElement.querySelector(".wp-block-prc-block-form-input-select__list"),a=l.querySelector(`[data-ref-value="${r}"]`);if(a){const e=l.querySelector(".is-selected");e&&e.classList.remove("is-selected"),a.classList.add("is-selected"),a.scrollIntoView({block:"nearest"})}e().activeIndex=o},onInputOptionClick:s(t=>{const n=e(),{facetSlug:c,choice:s}=n,{selected:o}=d,{value:r}=s;o[c]=[r]}),onInputCheckboxClick:s(t=>{const n=e(),{choice:c,facetSlug:s}=n,{selected:o}=d,{value:r,type:l}=c;d.isInputDisabled||(o[s]&&0!==o[s].length?o[s].includes(r)?o[s]=o[s].filter(e=>e!==r):o[s]="radio"===l?[r]:[...o[s],r]:o[s]=[r])}),onExpand:()=>{const t=e();t.expanded=!t.expanded},onCollapse:()=>{const t=e();let n=!1;n||(n=!0,setTimeout(()=>{t.expanded=!1,n=!1},150))}},callbacks:{onSelection(){const e=d.selected;Object.keys(e).length<=0?d.isDisabled=!0:(p.updateResults(),d.isDisabled=!1)},onEpSortByUpdate(){d.epSortByDate?d.selected.ep_sort__by_date=!0:delete d.selected.ep_sort__by_date},onExpand:()=>{const t=e(),{expanded:n}=t;t.expandedLabel=n?"- Less":"+ More"}}});
//# sourceMappingURL=view.js.map